name: GitHub Actions Demo
on: 
  push:
    branches:
      - 0.0.1
  pull_request:
    branches:
      - master
jobs:
  pytest:
    runs-on: ubuntu-latest
    steps:
      # - run: echo "🎉 The job was automatically triggered by a ${{ github.event_name }} event."
      # - run: echo "🐧 This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      # - run: echo "🔎 The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      
      - name: Check out repository code
        uses: actions/checkout@v2
      
      - name: Set up python
        uses: actions/setup-python@v2
      
      - name: Install Chrome
        run: |
          sudo wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | sudo apt-key add -
          sudo apt update
          sudo apt-get install google-chrome-stable

      - name: Install Library
        run: |
          pip install chromedriver-binary==93.*
          pip install selenium
          pip install pytest
          pip install flask
          pip install flask[async]
          pip install httpx
      
      # - run: echo "💡 The ${{ github.repository }} repository has been cloned to the runner."
      # - run: echo "🖥️ The workflow is now ready to test your code on the runner."
      
      # - name: List files in the repository
      #   run: |
      #     ls ${{ github.workspace }}

      - name: Start flask
        run: python app.py

      - name: Start test
        run: pytest test.py
      
      - run: echo "🍏 This job's status is ${{ job.status }}."
